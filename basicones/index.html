<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
	<title>Basicones</title>
</head>
<body>

<a href="javascript:;" id="wantPlay">I want play</a>
<div id="notMe" style="float: left; width: 100%; height: 100%;"></div>

<audio src="http://cdn-preview-b.deezer.com/stream/b18965a0efe1a8f312ff415c39397a51-1.mp3" id="audio">

<div id="dz-root"></div>
<script src="http://cdn-files.deezer.com/js/min/dz.js"></script>

<script src="/socket.io/socket.io.js"></script>
<script src="http://code.jquery.com/jquery-2.0.0.js"></script>
<script>
/*
	DZ.init({
		appId  : '116585',
		channelUrl : 'http://public.renangoncalves.com:8080/channel.html',
		player : {
			onload : function(){}
		}
	});
    */

	var socket = io.connect('http://public.renangoncalves.com', 8080);
	socket.on('connect', function (data) {
		$('body').css('background-color', '');
	});
	socket.on('start', function (data) {
		// Load Track
		//DZ.player.playAlbum(302127);

		// Play
		//DZ.player.setVolume(100);
		//DZ.player.seek(0);
		//DZ.player.play();
        //audio.play();
        $('#audio')[0].play();
	});
	socket.on('stop', function (data) {
        //audio.stop();
        $('#audio')[0].pause();
		//DZ.player.pause();
	});
	socket.on('change-color', function (data) {
		$('body').css('background-color', data.color);
	});

    //var audio = new Audio();
	$(document).ready(function() {
		$('#notMe, body').bind('click', function() {
			socket.emit('not-me', { not: 'me' });
		});

		$('#wantPlay').bind('click', function() {
			audio.play();
			audio.pause();
		});

        // load music to play
        //audio.src = 'http://195.68.237.84/bolnl/d2/264/458/ELCOAZKXYGMEPHLBCZAXRKWOYPME.wma';
        //audio.load();
        var audio = $('#audio')[0];
        audio.controls = 'controls';
        audio.load();

        // Call API
        $.ajax('http://api.deezer.com/2.0/album/302127?output=jsonp', {
        	dataType: 'jsonp',
        	success: function(data) {
        		var tracks = data.tracks.data;
        		var track = tracks[Math.floor(Math.random() * tracks.length)];
        		audio.src = track.preview;
        		audio.load();
        	}
        });
	});
</script>

</body>
</html>
